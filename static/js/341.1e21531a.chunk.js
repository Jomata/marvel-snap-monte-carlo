!function(){"use strict";function e(r){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(r)}function r(r){var n=function(r,n){if("object"!==e(r)||null===r)return r;var t=r[Symbol.toPrimitive];if(void 0!==t){var a=t.call(r,n||"default");if("object"!==e(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(r,"string");return"symbol"===e(n)?n:String(n)}function n(e,n,t){return(n=r(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function t(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function a(e){for(var r=1;r<arguments.length;r++){var a=null!=arguments[r]?arguments[r]:{};r%2?t(Object(a),!0).forEach((function(r){n(e,r,a[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):t(Object(a)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(a,r))}))}return e}function o(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function i(e,n){for(var t=0;t<n.length;t++){var a=n[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,r(a.key),a)}}function l(e,r,n){return r&&i(e.prototype,r),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var u="color:rgb(255,125,233)",s="color:green",c=[["Abomination","Abomination",5,9],["AbsorbingMan","Absorbing Man",4,3],["AdamWarlock","Adam Warlock",2,0],["Aero","Aero",5,7],["AgathaHarkness","Agatha Harkness",6,14],["Agent13","Agent 13",1,2],["AgentCoulson","Agent Coulson",3,4],["AmericaChavez","America Chavez",6,9],["Angel","Angel",1,2],["Angela","Angela",2,0],["AntMan","Ant Man",1,1],["Apocalypse","Apocalypse",6,8],["Armor","Armor",2,3],["ArnimZola","Arnim Zola",6,0],["Attuma","Attuma",4,10],["BaronMordo","Baron Mordo",2,3],["Bast","Bast",1,1],["Beast","Beast",2,2],["Bishop","Bishop",3,1],["BlackBolt","Black Bolt",5,8],["BlackCat","Black Cat",3,7],["BlackPanther","Black Panther",5,4],["BlackWidow","Black Widow",2,1],["Blade","Blade",1,3],["BlueMarvel","Blue Marvel",5,3],["Brood","Brood",3,2],["BuckyBarnes","Bucky Barnes",2,1],["Cable","Cable",2,2],["CaptainAmerica","Captain America",3,3],["CaptainMarvel","Captain Marvel",5,6],["Carnage","Carnage",2,2],["Cerebro","Cerebro",3,0],["Cloak","Cloak",2,4],["ColleenWing","Colleen Wing",2,4],["Colossus","Colossus",2,3],["Cosmo","Cosmo",3,3],["Crossbones","Crossbones",4,8],["Crystal","Crystal",4,4],["Cyclops","Cyclops",3,4],["Dagger","Dagger",2,1],["Daredevil","Daredevil",2,2],["Darkhawk","Darkhawk",4,1],["Dazzler","Dazzler",4,4],["Deadpool","Deadpool",1,1],["Death","Death",9,12],["Deathlok","Deathlok",3,5],["Debrii","Debrii",3,3],["Destroyer","Destroyer",6,15],["DevilDinosaur","Devil Dinosaur",5,3],["DoctorOctopus","Doctor Octopus",5,10],["DoctorStrange","Doctor Strange",3,3],["Domino","Domino",2,3],["Dracula","Dracula",4,0],["Drax","Drax",4,5],["DrDoom","Doctor Doom",6,5],["EbonyMaw","Ebony Maw",1,7],["Electro","Electro",3,2],["Elektra","Elektra",1,1],["Enchantress","Enchantress",4,4],["Falcon","Falcon",2,3],["Forge","Forge",2,1],["Galactus","Galactus",6,2],["Gambit","Gambit",3,1],["Gamora","Gamora",5,7],["Ghost","Ghost",1,2],["GhostRider","Ghost Rider",4,3],["Giganto","Giganto",6,14],["Goose","Goose",2,2],["GreenGoblin","Green Goblin",3,-3],["Groot","Groot",3,4],["Hawkeye","Hawkeye",1,1],["Hazmat","Hazmat",2,2],["Heimdall","Heimdall",6,8],["Hela","Hela",6,6],["Helicarrier","Helicarrier",6,10],["Hellcow","Hellcow",4,6],["Hobgoblin","Hobgoblin",5,-8],["Hood","The Hood",1,-2],["Hulk","Hulk",6,12],["Hulkbuster","Hulkbuster",3,4],["HumanTorch","Human Torch",1,2],["Iceman","Iceman",1,2],["Infinaut","The Infinaut",6,20],["InvisibleWoman","Invisible Woman",2,2],["IronFist","Iron Fist",1,2],["Ironheart","Ironheart",3,0],["IronMan","Iron Man",5,0],["JaneFoster","Jane Foster Mighty Thor",5,8],["JeffTheBabyLandShark","Jeff the Baby Land Shark",2,3],["JessicaJones","Jessica Jones",4,4],["Jubilee","Jubilee",4,1],["Juggernaut","Juggernaut",3,3],["Kang","Kang",5,0],["KaZar","Ka-Zar",4,4],["Killmonger","Killmonger",3,3],["Kingpin","Kingpin",3,4],["KittyPryde","Kitty Pryde",1,2],["Klaw","Klaw",5,4],["Knull","Knull",6,0],["Korg","Korg",1,2],["Kraven","Kraven",2,2],["LadySif","Lady Sif",3,4],["Leader","Leader",6,7],["Leech","Leech",5,3],["LivingTribunal","The Living Tribunal",6,4],["Lizard","Lizard",2,5],["Lockjaw","Lockjaw",3,2],["LukeCage","Luke Cage",2,1],["Magik","Magik",5,3],["Magneto","Magneto",6,12],["Mantis","Mantis",1,2],["MariaHill","Maria Hill",2,3],["MasterMold","Master Mold",2,2],["Maximus","Maximus",3,7],["MBaku","M'Baku",1,2],["Medusa","Medusa",2,2],["MilesMorales","Miles Morales",4,5],["MistyKnight","Misty Knight",1,2],["Modok","MODOK",5,8],["Mojo","Mojo",2,2],["MoonGirl","Moon Girl",4,4],["MoonKnight","Moon Knight",3,3],["Morbius","Morbius",2,0],["Morph","Morph",3,0],["MrFantastic","Mister Fantastic",3,2],["MrNegative","Mister Negative",4,-1],["MrSinister","Mister Sinister",2,2],["MultipleMan","Multiple Man",2,3],["Mysterio","Mysterio",2,4],["Mystique","Mystique",3,0],["Nakia","Nakia",3,2],["Namor","Namor",4,5],["NegasonicTeenageWarhead","Negasonic Teenage Warhead",3,2],["NickFury","Nick Fury",5,7],["Nightcrawler","Nightcrawler",1,2],["Nimrod","Nimrod",5,5],["Nova","Nova",1,1],["Odin","Odin",6,8],["Okoye","Okoye",2,2],["OmegaRed","Omega Red",4,5],["Onslaught","Onslaught",6,7],["Orka","Orka",6,9],["Patriot","Patriot",3,1],["Polaris","Polaris",3,5],["ProfessorX","Professor X",5,3],["Psylocke","Psylocke",2,1],["Punisher","Punisher",3,2],["Quake","Quake",2,3],["Quicksilver","Quicksilver",1,2],["Quinjet","Quinjet",1,2],["RedSkull","Red Skull",5,15],["Rescue","Rescue",4,4],["Rhino","Rhino",3,3],["RocketRaccoon","Rocket Raccoon",1,2],["Rockslide","Rockslide",4,6],["Rogue","Rogue",3,1],["Ronan","Ronan the Accuser",5,3],["Sabretooth","Sabretooth",3,4],["Sandman","Sandman",4,1],["Sauron","Sauron",3,3],["ScarletWitch","Scarlet Witch",2,3],["Scorpion","Scorpion",2,2],["Sentinel","Sentinel",2,3],["Sentry","Sentry",4,8],["Sera","Sera",5,4],["ShadowKing","Shadow King",4,3],["ShangChi","Shang-Chi",4,3],["Shanna","Shanna",4,2],["SheHulk","She-Hulk",6,10],["Shocker","Shocker",2,3],["Shuri","Shuri",4,2],["SilverSurfer","Silver Surfer",3,2],["Spectrum","Spectrum",6,5],["SpiderMan","Spider-Man",4,3],["SpiderWoman","Spider-Woman",5,7],["SquirrelGirl","Squirrel Girl",1,1],["Starlord","Star-Lord",2,2],["Stature","Stature",5,7],["Storm","Storm",3,2],["StrongGuy","Strong Guy",4,4],["Sunspot","Sunspot",1,1],["SuperSkrull","Super-Skrull",4,2],["Swarm","Swarm",2,3],["SwordMaster","Sword Master",3,6],["Taskmaster","Taskmaster",5,0],["Thanos","Thanos",6,8],["TheCollector","The Collector",2,1],["TheThing","The Thing",4,6],["Thor","Thor",3,4],["Titania","Titania",1,5],["TyphoidMary","Typhoid Mary",4,10],["Uatu","Uatu the Watcher",1,2],["Ultron","Ultron",6,8],["Valkyrie","Valkyrie",5,3],["Venom","Venom",3,1],["Viper","Viper",2,3],["Vision","Vision",5,7],["Vulture","Vulture",3,3],["Warpath","Warpath",4,5],["Wasp","Wasp",0,1],["Wave","Wave",3,3],["WhiteQueen","White Queen",4,6],["WhiteTiger","White Tiger",5,1],["Wolfsbane","Wolfsbane",3,1],["Wolverine","Wolverine",2,2],["Wong","Wong",4,2],["Yellowjacket","Yellowjacket",0,2],["Yondu","Yondu",1,2],["Zabu","Zabu",2,2],["Zero","Zero",1,3]];var h=function(){function e(r,n,t){o(this,e),this.name=void 0,this.energy=0,this.power=0,this.revealed=!1,this.onReveal=void 0,this.name=r,Object.assign(this,n),Object.assign(this,t)}return l(e,[{key:"copy",value:function(r,n){return new e(this.name,a(a({},this),r),n)}},{key:"getEffectiveCost",value:function(e){var r=this.energy;if(e.field.some((function(e){return"Sera"===e.name}))&&(r=Math.max(1,r-1)),e.field.some((function(e){return"Zabu"===e.name}))&&4===this.energy&&(r-=1),e.field.some((function(e){return"Wave"===e.name}))){var n=e.turn;if(e.history.some((function(e){return e.turn===n-1&&e.field.some((function(e){return"Wave"===e.name&&!1===e.revealed}))})))return 4}return r}},{key:"isPlayable",value:function(e){return e.getAvailableEnergy()>=this.getEffectiveCost(e)}},{key:"revealCard",value:function(e){var r=this;console.log(" > Revealing %c".concat(this.name),u);var n=this.copy({revealed:!0}),t=e.copy({field:e.field.filter((function(e){return e!==r})).concat(n)});return this.onReveal?this.onReveal(t):t}},{key:"toString",value:function(){return"".concat(this.name," (").concat(this.energy,"/").concat(this.power,")")}}],[{key:"createFromName",value:function(r){var n=c.find((function(e){return e[0]===r}));if(!n)return new e(r);var t=new e(r,{energy:n[2],power:n[3]});switch(r){case"Bast":return t.copy({},{onReveal:function(e){var r=e.hand.map((function(e){return e.copy({power:3})}));return e.copy({hand:r})}});case"Electro":return t.copy({},{onReveal:function(e){return e.addHook({name:"Electro onReveal",oneTimeOnly:!0,onTurnStart:function(e){return e.copy({baseEnergy:e.baseEnergy+1})}})}});case"Psylocke":return t.copy({},{onReveal:function(e){return e.addHook({name:"Psylocke onReveal",oneTimeOnly:!0,onTurnStart:function(e){return e.copy({tempEnergy:e.tempEnergy+1})}})}});case"Zabu":return t.copy({});case"Jubilee":return t.copy({},{onReveal:function(e){var n,t=(n=e.library)[n.length*Math.random()|0];return console.log(" > %c".concat(r," %cpulls %c").concat(t.name),u,"",u),e.copy({library:e.library.filter((function(e){return e!==t})),field:e.field.concat(t)})}});case"Mister Negative":return t.copy({},{onReveal:function(e){var r=e.library.map((function(e){return e.copy({power:e.energy,energy:Math.max(0,e.power)})}));return e.copy({library:r})}});default:return t}}}]),e}();function y(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,t=new Array(r);n<r;n++)t[n]=e[n];return t}function f(e){return function(e){if(Array.isArray(e))return y(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,r){if(e){if("string"===typeof e)return y(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(e,r):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,r){if(!e){var n="Check failed";throw"string"===typeof r&&(n=r),"function"===typeof r&&(n=r()),new Error(n)}}var d=function(){function e(r,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];o(this,e),this.deck=void 0,this.turn=0,this.baseEnergy=0,this.tempEnergy=0,this.usedEnergy=0,this.hand=[],this.library=[],this.field=[],this.history=[],this.hooks=[],this.deck=r,Object.assign(this,n),this.hooks=t,this.history=a,this.validateState()}return l(e,[{key:"validateState",value:function(){g(12===this.deck.length,"deck.length is ".concat(this.deck.length)),g(this.hand.length<=7,"hand.length is ".concat(this.hand.length)),g(this.turn>=0&&this.turn<=7,"turn is ".concat(this.turn))}},{key:"copy",value:function(r,n){return new e(this.deck,a(a({},this),r),null!==n&&void 0!==n?n:this.hooks,[].concat(f(this.history),[this]))}},{key:"addHook",value:function(e){return this.copy({},[].concat(f(this.hooks),[e]))}},{key:"debug",value:function(){console.table({turn:this.turn,energy:this.getAvailableEnergy(),hand:this.hand.map((function(e){return e.name})),field:this.field.map((function(e){return e.name})),library:this.library.map((function(e){return e.name}))})}},{key:"startGame",value:function(){var e=function(e){for(var r,n=e.length;0!==n;){r=Math.floor(Math.random()*n),n--;var t=[e[r],e[n]];e[n]=t[0],e[r]=t[1]}return e}(f(this.deck)),r=e.slice(0,3),n=e.slice(3);return console.log("Opening hand",r.map((function(e){return e.name}))),this.copy({turn:0,baseEnergy:0,tempEnergy:0,hand:r,library:n})}},{key:"onTurnStart",value:function(){return this.hooks.reduce((function(e,r){if(r.onTurnStart){console.log(" > Running onTurnStart hook",r.name);var n=r.onTurnStart(e);return r.oneTimeOnly?n.copy({},e.hooks.filter((function(e){return e!==r}))):n}return e}),this)}},{key:"startTurn",value:function(){console.log("Turn ".concat(this.turn+1," start"));var e=this.hand.length<7,r=this.library.slice(0,1)[0];e?console.log(" > Drew %c".concat(r.name),u):console.log(" > Full hand, skipping draw");var n=e?this.library.slice(1):this.library,t=e?[].concat(f(this.hand),[r]):this.hand;return this.copy({turn:this.turn+1,baseEnergy:this.baseEnergy+1,tempEnergy:0,usedEnergy:0,hand:t,library:n}).onTurnStart()}},{key:"endTurn",value:function(){var e=this.field.filter((function(e){return!1===e.revealed}));return console.log("Turn ".concat(this.turn," end")),e.reduce((function(e,r){return r.revealCard(e)}),this)}},{key:"playCard",value:function(e){return console.log(" > Playing %c".concat(e.name," %cusing %c").concat(e.getEffectiveCost(this),"/").concat(this.getAvailableEnergy()," %cenergy"),u,"",s,""),this.copy({hand:this.hand.filter((function(r){return r!==e})),field:[].concat(f(this.field),[e]),usedEnergy:this.usedEnergy+e.getEffectiveCost(this)})}},{key:"playTurn",value:function(e){var r=this.startTurn();return e.reduce((function(e,r){return e.playCardIfPossible(r)}),r).endTurn()}},{key:"playCardIfPossible",value:function(e){var r=this.hand.find((function(r){return r.name===e}));return void 0===r?this.copy():r.isPlayable(this)?this.playCard(r):this.copy()}},{key:"getAvailableEnergy",value:function(){return this.baseEnergy+this.tempEnergy-this.usedEnergy}}]),e}(),m=function(){function e(){o(this,e)}return l(e,null,[{key:"run",value:function(e,r,n,t,a){console.log("Run");for(var o={iterations:0,successes:0,failures:0,sampleGame:{hand:[],field:[],library:[]}},i=function(){o.iterations++,r%10===0&&a&&a(o.iterations/r);var i=new d(e).startGame().playTurn(n.turn1).playTurn(n.turn2).playTurn(n.turn3).playTurn(n.turn4).playTurn(n.turn5).playTurn(n.turn6),l=i.field.some((function(e){return"Magik"===e.name}))?i.playTurn(n.turn7):i;t.every((function(e){return l.field.some((function(r){return r.name===e}))}))?o.successes++:o.failures++,o.sampleGame={hand:l.hand.map((function(e){return e.name})),field:l.field.map((function(e){return e.name})),library:l.library.map((function(e){return e.name}))}},l=0;l<r;l++)i();return o}}]),e}(),p=globalThis;p.onmessage=function(e){console.log("Worker received:",e.data),console.time("worker");var r=e.data.cards.map((function(e){return h.createFromName(e)})),n=m.run(r,e.data.runs,e.data.logic,e.data.expected,(function(e){p.postMessage({type:"progress",progress:e})}));p.postMessage({type:"result",result:n}),console.timeEnd("worker"),console.log("Worker response sent")}}();
//# sourceMappingURL=341.1e21531a.chunk.js.map